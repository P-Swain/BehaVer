<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Verilog Graph Viewer</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        #viewer-frame {
            border: 1px solid #e2e8f0;
            border-radius: 0.5rem;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
        }
    </style>
</head>
<body class="bg-slate-50 text-slate-800 flex flex-col h-screen p-4 md:p-6">

    <header class="mb-4">
        <h1 class="text-2xl font-bold text-slate-900">Verilog Design Explorer</h1>
        <p class="text-slate-600">Click on a component in the architectural view to drill down into its detailed implementation.</p>
    </header>

    <div id="navigation-bar" class="flex items-center gap-4 bg-white p-3 rounded-lg shadow-sm mb-4 border border-slate-200">
        <button id="home-button" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-md transition-colors duration-200">
            Home (Architectural View)
        </button>
        <div class="flex items-center gap-2">
            <span class="font-semibold text-slate-700">Current View:</span>
            <span id="current-view-label" class="bg-slate-100 text-slate-800 font-mono text-sm px-3 py-1 rounded-md"></span>
        </div>
    </div>

    <main class="flex-1 bg-white rounded-lg overflow-hidden">
        <iframe id="viewer-frame" class="w-full h-full" src=""></iframe>
    </main>

    <script>
        const viewerFrame = document.getElementById('viewer-frame');
        const currentViewLabel = document.getElementById('current-view-label');
        const homeButton = document.getElementById('home-button');
        let architecturalViewSrc = '';

        // Function to find the main architectural SVG file in the current directory
        function findArchitecturalView() {
            // This simple logic assumes the architectural view is the only one ending in "_arch.svg"
            // It makes a dummy request to check if the file exists.
            const potentialArchFile = window.location.pathname.split('/').pop().replace('.html', '') + '_arch.svg';
            // A better method in a real web server would be to list files,
            // but for a local file setup, we guess the name.
            // A more robust local solution is to just hardcode the expected name.
            
            // Let's assume the Verilog file was 'picorv32.v', so the output base is 'picorv32_arch'
            // We can derive this from the HTML file name if we name it consistently.
            const baseName = document.location.pathname.match(/([^/]+)\.html$/)[1];
            // If viewer is picorv32_arch.html, baseName is picorv32_arch
            const archFile = baseName + ".svg";

            // Fallback for generic viewer name
            // You might need to adjust this logic based on your output file names.
            // A simple solution is to just prompt the user or hardcode it.
            // For now, let's prompt if we can't guess.
            
            // Simplified approach: Guess common names.
            const potentialFiles = ['picorv32_arch.svg', 'test_arch.svg', 'top_arch.svg'];
            // In a real scenario, you'd pass the filename from the python script.
            // For this self-contained example, we'll hardcode a likely candidate.
            // PLEASE RENAME THIS to match your output file.
            architecturalViewSrc = 'picorv32_arch.svg'; 

            return architecturalViewSrc;
        }

        function setView(src) {
            if (src) {
                viewerFrame.src = src;
                currentViewLabel.textContent = src;
            } else {
                 viewerFrame.src = 'about:blank';
                 currentViewLabel.textContent = 'No SVG loaded. Please generate graphs first.';
            }
        }

        // --- Initialization ---
        document.addEventListener('DOMContentLoaded', () => {
            const archSrc = findArchitecturalView();
            setView(archSrc);
        });

        homeButton.addEventListener('click', () => {
            setView(architecturalViewSrc);
        });
    </script>
</body>
</html>
